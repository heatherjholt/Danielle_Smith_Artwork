<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- favicon generated at https://redketchup.io/favicon-generator -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <title>Danielle Smith</title>
</head>

<body>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-container" id="flashContainer">
      {% for category, message in messages %}
        <div class="flash flash-{{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}


    <div class="container">
        <!-- header -->
        <div class="header">
            <div class="artist-name"><a href="{{ url_for('home') }}" class="artist-link">DANIELLE SMITH</a></div>
            <div class="nav-links">
                <a href="{{ url_for('about') }}">ABOUT</a>
                <a href="{{ url_for('home') }}">GALLERY</a>
                <a href="{{ url_for('contact') }}">CONTACT</a>
            </div>  
        </div>
        <!--end of header-->

        <!--main content-->
        <nav class="admin-nav">
            <a href="#upload-section">UPLOAD ARTWORK</a>
            <a href="#manage-section">MANAGE ARTWORK</a>
            <a href="#about-section">ABOUT PAGE</a>
        </nav>



        <section id="upload-section" class="gallery-section">
        <h2 class="section-heading">UPLOAD NEW ARTWORK</h2>

        <form class="admin-upload" action="{{ url_for('upload_art') }}" method="POST" enctype="multipart/form-data">
            <div id="dropzone" class="dropzone">
            <p id="dropText">Drag & drop an image here, or click to open File Explorer.</p>
            <!-- capture="environment" --><!--taken out for testing-->
            <input
                id="artFile"
                name="art_file"
                type="file"
                accept="image/*"
                hidden
                >
            </div>
            <!--testing mobile-->
            <div class="mobile-pick-row">
            <button type="button" class="pick-btn" id="takePhotoBtn">TAKE PHOTO</button>
            <button type="button" class="pick-btn" id="choosePhotoBtn">CHOOSE PHOTO</button>
            </div>

            <input id="cameraFile" name="art_file" type="file" accept="image/*" capture="environment" hidden disabled>

        <div class="preview-wrap">
            <img id="previewImg" class="preview-img" alt="Preview" style="display:none;">
        </div>

            <label class="form-label">
                TITLE: <input type="text" name="title" class="text-input">
            </label>   

            <label class="form-label">
                DESCRIPTION: <textarea name="description" class="text-area" rows="2"></textarea>
            </label>

            <label class="form-label">
                MEDIUM: <select name="medium" class="medium-select">
                <option value=""></option>
                <option value="Painting">PAINTING</option>
                <option value="Drawing">DRAWING</option>
                <option value="Mixed Media">MIXED MEDIA</option>
                <option value="Digital">DIGITAL</option>
                <option value="Other">OTHER</option>
            </select>
            </label>

            <button type="submit" class="upload-btn" id="uploadBtn" disabled>UPLOAD</button>
        </form>
        
    <div class="section-divider"></div>

        <h2 id="manage-section" class="section-heading">MANAGE ARTWORK</h2>

            <div id="manageList" class="manage-list">
                {% for art in artworks %}
                <div class="manage-item" data-id="{{ art.saved_id }}">
                    <button class="drag-handle" type="button" aria-label="Reorder">⋮⋮</button>

                    <img class="manage-thumb" src="{{ url_for('static', filename='artwork/' ~ art.image) }}" alt="">

                    <div class="manage-info">
                    <div class="manage-title">{{ art.title or "(untitled)" }}</div>
                    <div class="manage-sub">{{ art.medium or "" }}</div>

                    <div class="manage-actions">
                        <button
                            type="button"
                            class="edit-btn"
                            data-id="{{ art.saved_id }}"
                            data-title="{{ art.title|default('')|e }}"
                            data-medium="{{ art.medium|default('')|e }}"
                            data-description="{{ art.description|default('')|e }}"
                            data-image="{{ art.image|default('')|e }}"
                        >
                        EDIT
                        </button>
                        <form action="/admin/art/{{ art.saved_id }}/delete" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this artwork?');">
                        <button type="submit">DELETE</button>
                        </form>
                    </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div id="artModal" class="modal hidden" aria-hidden="true">
            <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
                <div class="modal-header">
                <div id="modalTitle" class="modal-title">EDIT ARTWORK</div>
                <button type="button" class="modal-close" id="modalClose" aria-label="Close">&times;</button>
                </div>

                <form id="editForm" method="POST" enctype="multipart/form-data">
                <label class="form-label">
                    TITLE:
                    <input type="text" name="title" id="modalTitleInput">
                </label>

                <label class="form-label">
                    MEDIUM:
                    <select name="medium" id="modalMediumInput">
                    <option value="">SELECT</option>
                    <option value="Painting">PAINTING</option>
                    <option value="Drawing">DRAWING</option>
                    <option value="Print">PRINT</option>
                    <option value="Digital">DIGITAL</option>
                    <option value="Mixed Media">MIXED MEDIA</option>
                    </select>
                </label>

                <label class="form-label">
                    DESCRIPTION:
                    <textarea name="description" id="modalDescriptionInput" rows="3"></textarea>
                </label>

                <div class="modal-preview-row">
                    <img id="modalPreviewImg" class="modal-preview" alt="" />
                </div>

                <label class="form-label">
                    REPLACE IMAGE:
                    <input type="file" name="art_file" id="modalFileInput" accept="image/*">
                </label>

                <div class="modal-actions">
                    <button type="submit" class="small-btn">SAVE</button>

                    <button type="button" class="small-btn danger" id="deleteBtn">
                    DELETE
                    </button>
                </div>
                </form>
            </div>
            </div>

    <div class="section-divider"></div>

            <section id="about-section" class="gallery-section">
                <h2 class="section-heading">EDIT ABOUT PAGE</h2>

                <form action="{{ url_for('update_about') }}" method="POST" class="admin-upload">
                    <label class="form-label">
                    HEADER:
                    <input
                        type="text"
                        name="about_header"
                        class="text-input"
                        value="{{ about.header if about else '' }}"
                        placeholder="ABOUT"
                    >
                    </label>

                    <label class="form-label">
                    PARAGRAPH:
                    <textarea
                        name="about_body"
                        class="text-area"
                        rows="8"
                        placeholder="Danielle's bio..."
                    >{{ about.body if about else '' }}</textarea>
                    </label>

                    <button type="submit" class="upload-btn">Save</button>
                </form>
            </section>

        </section>

        <div class="admin-logout">
            <a href="{{ url_for('logout') }}">LOGOUT</a>
        </div>

        <div class="section-divider"></div>
        <h2 class="section-heading">MESSAGES</h2>

        <div class="message-grid">
        {% if messages and messages|length %}
        {% for msg in messages %}
        <div class="message-card">

        <div class="message-top">
            <div class="message-meta">
            <div class="message-name">{{ msg.name or "Anonymous" }}</div>
            <a class="message-email" href="mailto:{{ msg.email }}">{{ msg.email }}</a>
            <div class="message-date">
                {{ msg.date_sent.strftime("%b %d, %Y %I:%M %p") if msg.date_sent else "" }}
            </div>
            </div>

            <form method="POST"
                action="{{ url_for('delete_messages', msg_id=msg.id) }}"
                onsubmit="return confirm('Delete this message?');">
            <button type="submit" class="small-btn danger">DELETE</button>
            </form>
        </div>

            <div class="message-body">{{ msg.message_body }}</div>

            </div>
        {% endfor %}
        {% else %}
        <p>No messages yet.</p>
        {% endif %}
        </div>



        <div class="section-divider"></div>

        <!--end of main content-->

        <!--footer-->
        <!-- <div class="section-divider"></div> -->

        <footer class="footer">
            <span>&copy; G+H Digital Designs</span>
        </footer>
        <!--end of footer-->

    </div>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.6/Sortable.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>
